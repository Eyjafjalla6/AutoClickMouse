# 智能自动点击器 - 改进版

基于原 `autoclick.py` 的重大改进，提供了完整的图形用户界面，让用户可以轻松创建和管理自动化点击任务。

## 主要改进功能

### 1. 图形用户界面 (GUI)
- 直观的操作界面，无需修改代码
- 实时状态显示和进度跟踪
- 操作序列可视化管理

### 2. 三种操作节点类型

#### 图片匹配点击节点
- 通过图像识别自动点击指定位置
- 可调节匹配阈值 (0.01-0.5)
- 支持多次尝试机制
- 自定义操作名称

#### 时间延迟节点  
- 在操作序列中添加等待时间
- 支持1秒到1小时的延迟
- 实时倒计时显示

#### 鼠标拖动匹配点击节点
- 自动拖动屏幕直到找到目标图片
- 可调节滑动距离和最大滑动次数
- 找到目标后自动点击

### 3. 操作序列管理
- 拖拽式操作排序 (上移/下移)
- 单个或批量删除操作
- 一键清空操作序列
- 实时操作列表显示

### 4. 配置保存与加载
- 支持JSON格式配置文件
- 可保存和加载完整的操作序列
- 便于重复使用和分享配置

### 5. 多线程执行
- 非阻塞式界面，执行时可随时停止
- 实时状态更新
- 安全的中断机制

## 使用方法

### 快速启动
```bash
cd code
python run_gui.py
```

### 直接启动
```bash
cd code  
python autoclick_gui.py
```

### 使用步骤
1. 启动程序后，点击相应按钮添加操作节点
2. 配置每个节点的参数（图片路径、延迟时间等）
3. 使用上移/下移按钮调整操作顺序
4. 点击"开始执行"运行自动化任务
5. 可随时点击"停止执行"中断任务

### 加载示例配置
1. 启动GUI界面
2. 点击"加载配置"按钮
3. 选择 `example_config.json` 文件
4. 点击"开始执行"运行示例流程

## 文件说明

- `autoclick_gui.py` - 主要的GUI程序文件
- `run_gui.py` - 启动脚本，包含依赖检查
- `example_config.json` - 示例配置文件，对应原流程
- `autoclick.py` - 原始版本（保留供参考）

## 依赖要求

```bash
pip install opencv-python pyautogui Pillow
```

**注意**: `tkinter` 通常是Python标准库的一部分，无需额外安装。

## 与原版本的对比

| 功能 | 原版本 | 改进版 |
|------|--------|--------|
| 用户界面 | 无，需要修改代码 | 完整图形界面 |
| 操作配置 | 硬编码在代码中 | 可视化配置 |
| 操作类型 | 有限的图片点击 | 三种操作节点 |
| 序列管理 | 固定流程 | 可自由组合 |
| 配置保存 | 不支持 | JSON格式保存/加载 |
| 执行控制 | 一次性执行 | 可随时停止/继续 |

## 使用技巧

1. **图片匹配**: 使用较小的阈值(0.01-0.05)可获得更精确的匹配
2. **延迟设置**: 在网络较慢或应用加载较慢时适当增加延迟时间
3. **拖动操作**: 对于需要滚动的界面，使用拖动匹配节点
4. **配置保存**: 将常用流程保存为配置文件，便于重复使用

## 注意事项

- 确保目标应用窗口在前台可见
- 图片模板应与实际显示内容一致
- 执行过程中不要移动鼠标，以免干扰自动化
- 首次使用建议先测试单个操作节点

## 故障排除

如果遇到问题：
1. 检查所有依赖是否已正确安装
2. 确认图片路径是否正确
3. 调整匹配阈值以获得更好的识别效果
4. 增加延迟时间以适应较慢的应用响应
